"use strict";(()=>{var e={};e.id=526,e.ids=[526,888,660],e.modules={1323:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},4555:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{config:()=>m,default:()=>x,getServerSideProps:()=>h,getStaticPaths:()=>p,getStaticProps:()=>g,reportWebVitals:()=>b,routeModule:()=>S,unstable_getServerProps:()=>j,unstable_getServerSideProps:()=>v,unstable_getStaticParams:()=>P,unstable_getStaticPaths:()=>y,unstable_getStaticProps:()=>f});var a=s(7093),n=s(5244),i=s(1323),l=s(2899),c=s.n(l),o=s(6814),d=s(5777),u=e([o,d]);[o,d]=u.then?(await u)():u;let x=(0,i.l)(d,"default"),g=(0,i.l)(d,"getStaticProps"),p=(0,i.l)(d,"getStaticPaths"),h=(0,i.l)(d,"getServerSideProps"),m=(0,i.l)(d,"config"),b=(0,i.l)(d,"reportWebVitals"),f=(0,i.l)(d,"unstable_getStaticProps"),y=(0,i.l)(d,"unstable_getStaticPaths"),P=(0,i.l)(d,"unstable_getStaticParams"),j=(0,i.l)(d,"unstable_getServerProps"),v=(0,i.l)(d,"unstable_getServerSideProps"),S=new a.PagesRouteModule({definition:{kind:n.x.PAGES,page:"/chef",pathname:"/chef",bundlePath:"",filename:""},components:{App:o.default,Document:c()},userland:d});r()}catch(e){r(e)}})},5777:(e,t,s)=>{s.a(e,async(e,r)=>{try{s.r(t),s.d(t,{default:()=>o});var a=s(997),n=s(6689),i=s(1163),l=s(3673),c=e([l]);l=(c.then?(await c)():c)[0];let o=()=>{let[e,t]=(0,n.useState)([]),[s,r]=(0,n.useState)(!0),[c,o]=(0,n.useState)(null),d=(0,i.useRouter)();(0,n.useEffect)(()=>{if(!l.k.isAuthenticated()){d.push("/login");return}let e=l.k.getCurrentUser();if(e?.role!=="chef"){d.push("/");return}u();let s=new WebSocket("ws://localhost:8000/ws");return s.onopen=()=>{console.log("WebSocket connected")},s.onmessage=e=>{let s=JSON.parse(e.data);"new_order"===s.type?u():"status_updated"===s.type&&t(e=>e.map(e=>e.id===s.order_id?{...e,status:s.status}:e))},s.onclose=()=>{console.log("WebSocket disconnected")},o(s),()=>{s&&s.close()}},[]);let u=async()=>{try{let e=await fetch("/api/orders/chef/"),s=await e.json();t(s)}catch(e){console.error("Error loading orders:",e)}finally{r(!1)}},x=async(e,t)=>{c&&c.readyState===WebSocket.OPEN&&c.send(JSON.stringify({type:"status_update",order_id:e,status:t}))},g=e=>({new:"bg-blue-100 text-blue-800",processing:"bg-yellow-100 text-yellow-800",baking:"bg-orange-100 text-orange-800",ready:"bg-green-100 text-green-800",delivered:"bg-purple-100 text-purple-800",cancelled:"bg-red-100 text-red-800"})[e]||"bg-gray-100 text-gray-800";return s?a.jsx("div",{className:"min-h-screen bg-cream flex items-center justify-center",children:a.jsx("div",{className:"text-2xl",children:"Загрузка..."})}):a.jsx("div",{className:"min-h-screen bg-cream",children:(0,a.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[a.jsx("h1",{className:"text-3xl font-serif",children:"Панель кондитера"}),a.jsx("div",{className:"text-right",children:(0,a.jsxs)("div",{className:"text-lg",children:["Активных заказов: ",e.length]})})]}),0===e.length?(0,a.jsxs)("div",{className:"text-center py-16",children:[a.jsx("div",{className:"text-6xl mb-4",children:"\uD83C\uDF70"}),a.jsx("h2",{className:"text-2xl font-serif mb-2",children:"Нет активных заказов"}),a.jsx("p",{className:"text-gray-600",children:"Новые заказы появятся здесь автоматически"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-xl font-bold",children:["Заказ #",e.id]}),a.jsx("p",{className:"text-gray-600",children:e.user.username})]}),(0,a.jsxs)("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${g(e.status)}`,children:["new"===e.status&&"Новый","processing"===e.status&&"В обработке","baking"===e.status&&"Готовится","ready"===e.status&&"Готов","delivered"===e.status&&"Доставлен","cancelled"===e.status&&"Отменён"]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("p",{className:"text-2xl font-bold text-chocolate",children:[e.total_price," ₽"]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Доставка: ",new Date(e.delivery_date).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:["new"===e.status&&a.jsx("button",{onClick:()=>x(e.id,"processing"),className:"bg-yellow-500 text-white px-3 py-1 rounded text-sm hover:bg-yellow-600 transition",children:"Взять в работу"}),"processing"===e.status&&a.jsx("button",{onClick:()=>x(e.id,"baking"),className:"bg-orange-500 text-white px-3 py-1 rounded text-sm hover:bg-orange-600 transition",children:"Начать готовить"}),"baking"===e.status&&a.jsx("button",{onClick:()=>x(e.id,"ready"),className:"bg-green-500 text-white px-3 py-1 rounded text-sm hover:bg-green-600 transition",children:"Готов"}),("new"===e.status||"processing"===e.status||"baking"===e.status)&&a.jsx("button",{onClick:()=>x(e.id,"cancelled"),className:"bg-red-500 text-white px-3 py-1 rounded text-sm hover:bg-red-600 transition",children:"Отменить"})]})]},e.id))})]})})};r()}catch(e){r(e)}})},5244:(e,t)=>{var s;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")},9648:e=>{e.exports=import("axios")}};var t=require("../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[567,424,899,814],()=>s(4555));module.exports=r})();