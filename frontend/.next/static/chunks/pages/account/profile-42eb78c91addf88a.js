(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[771],{5845:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account/profile",function(){return s(5863)}])},5863:function(e,t,s){"use strict";s.r(t);var l=s(5893),a=s(7294),n=s(9008),i=s.n(n),r=s(1664),c=s.n(r),m=s(1163),d=s(2336);t.default=()=>{let[e,t]=(0,a.useState)(null),[s,n]=(0,a.useState)(!0),[r,o]=(0,a.useState)({first_name:"",last_name:"",email:"",phone:""}),[x,h]=(0,a.useState)(!1),[u,f]=(0,a.useState)(null),p=(0,m.useRouter)();(0,a.useEffect)(()=>{if(!d.k.isAuthenticated()){p.push("/login");return}let e=d.k.getCurrentUser();if(e){let s={id:e.id,username:e.username,email:e.email,first_name:e.first_name||"",last_name:e.last_name||"",phone:e.phone||""};t(s),o({first_name:s.first_name,last_name:s.last_name,email:s.email,phone:s.phone})}n(!1)},[p]);let j=e=>{let{name:t,value:s}=e.target;o(e=>({...e,[t]:s}))},b=async e=>{e.preventDefault(),h(!0),f(null);try{await new Promise(e=>setTimeout(e,1e3));let e=d.k.getCurrentUser();if(e){let s={...e,first_name:r.first_name,last_name:r.last_name,email:r.email,phone:r.phone};localStorage.setItem("user",JSON.stringify(s)),t(s)}f({type:"success",text:"Профиль успешно обновлен!"})}catch(e){f({type:"error",text:"Ошибка при обновлении профиля"})}finally{h(!1)}};return s?(0,l.jsx)("div",{className:"min-h-screen bg-cream flex items-center justify-center",children:(0,l.jsx)("div",{className:"text-xl",children:"Загрузка..."})}):e?(0,l.jsxs)("div",{className:"min-h-screen bg-cream",children:[(0,l.jsxs)(i(),{children:[(0,l.jsx)("title",{children:"Настройки профиля - Уездный Кондитер"}),(0,l.jsx)("meta",{name:"description",content:"Редактирование профиля в кондитерской 'Уездный Кондитер'"})]}),(0,l.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,l.jsx)("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-serif font-bold text-chocolate mb-2",children:"Настройки профиля"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Редактирование личной информации"})]}),(0,l.jsx)(c(),{href:"/account",className:"text-chocolate hover:underline",children:"← Назад в кабинет"})]})}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 max-w-2xl",children:[u&&(0,l.jsx)("div",{className:"mb-6 p-4 rounded-lg ".concat("success"===u.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:u.text}),(0,l.jsxs)("form",{onSubmit:b,children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Имя"}),(0,l.jsx)("input",{type:"text",id:"first_name",name:"first_name",value:r.first_name,onChange:j,className:"input-field w-full",placeholder:"Введите ваше имя"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Фамилия"}),(0,l.jsx)("input",{type:"text",id:"last_name",name:"last_name",value:r.last_name,onChange:j,className:"input-field w-full",placeholder:"Введите вашу фамилию"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,l.jsx)("input",{type:"email",id:"email",name:"email",value:r.email,onChange:j,className:"input-field w-full",placeholder:"your@email.com"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Телефон"}),(0,l.jsx)("input",{type:"tel",id:"phone",name:"phone",value:r.phone,onChange:j,className:"input-field w-full",placeholder:"+7 (XXX) XXX-XX-XX"})]})]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,l.jsx)("button",{type:"submit",disabled:x,className:"btn-primary py-2 px-6 ".concat(x?"opacity-50 cursor-not-allowed":""),children:x?"Сохранение...":"Сохранить изменения"}),(0,l.jsx)(c(),{href:"/account/change-password",className:"mt-4 sm:mt-0 text-chocolate hover:underline",children:"Изменить пароль"})]})]})]}),(0,l.jsxs)("div",{className:"mt-8 bg-white rounded-xl shadow-md p-6 max-w-2xl",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Опасная зона"}),(0,l.jsx)("p",{className:"text-gray-700 mb-4",children:"Удаление аккаунта приведет к безвозвратному удалению всех ваших данных, включая историю заказов и персональную информацию."}),(0,l.jsx)("button",{onClick:()=>{confirm("Вы уверены, что хотите удалить свой аккаунт? Это действие нельзя отменить.")&&(d.k.logout(),p.push("/"))},className:"bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-lg transition",children:"Удалить аккаунт"})]})]})]}):(0,l.jsx)("div",{className:"min-h-screen bg-cream flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[(0,l.jsx)("h1",{className:"text-2xl font-bold text-chocolate mb-4",children:"Ошибка загрузки данных"}),(0,l.jsx)(c(),{href:"/account",className:"text-chocolate hover:underline",children:"← Вернуться в кабинет"})]})})}},9008:function(e,t,s){e.exports=s(3867)}},function(e){e.O(0,[888,774,179],function(){return e(e.s=5845)}),_N_E=e.O()}]);