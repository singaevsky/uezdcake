"use strict";exports.id=791,exports.ids=[791],exports.modules={1323:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,a){return a in t?t[a]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,a)):"function"==typeof t&&"default"===a?t:void 0}}})},5252:(e,t,a)=>{a.d(t,{Z:()=>s});var r=a(997),l=a(6689),n=a(1664),c=a.n(n);let i=()=>{let[e,t]=(0,l.useState)([]),[a,r]=(0,l.useState)(!0),n=(0,l.useCallback)(()=>{try{let e=localStorage.getItem("cart");if(e){let a=JSON.parse(e);Array.isArray(a)?t(a):(console.warn("Некорректные данные корзины в localStorage, сброс до пустой корзины."),t([]),localStorage.removeItem("cart"))}}catch(e){console.error("Ошибка при загрузке корзины из localStorage:",e),t([])}finally{r(!1)}},[]),c=(0,l.useCallback)(e=>{try{localStorage.setItem("cart",JSON.stringify(e)),window.dispatchEvent(new StorageEvent("cart_update",{key:"cart",newValue:JSON.stringify(e)}))}catch(e){console.error("Ошибка при сохранении корзины в localStorage:",e)}},[]);(0,l.useEffect)(()=>{n();let e=e=>{if("cart"===e.key&&"cart_update"===e.type||"cart"===e.key&&"storage"===e.type)try{let a=e.newValue;if(null===a)t([]);else{let e=JSON.parse(a);Array.isArray(e)&&t(e)}}catch(e){console.error("Ошибка при обновлении корзины из StorageEvent:",e)}};return window.addEventListener("cart_update",e),window.addEventListener("storage",e),()=>{window.removeEventListener("cart_update",e),window.removeEventListener("storage",e)}},[n]);let i=(0,l.useCallback)(e=>{"function"==typeof e?t(t=>{let a=e(t);return c(a),a}):(t(e),c(e))},[c]),s=(0,l.useCallback)(e=>{i(t=>{let a;let r=t.findIndex(t=>t.id===e.id);return r>=0?(a=[...t])[r]={...a[r],quantity:a[r].quantity+1}:a=[...t,{...e,quantity:1}],a})},[i]),o=(0,l.useCallback)(e=>{i(t=>t.filter(t=>t.id!==e))},[i]),d=(0,l.useCallback)((e,t)=>{if(t<=0){o(e);return}i(a=>a.map(a=>a.id===e?{...a,quantity:t}:a))},[o,i]),u=(0,l.useCallback)(()=>{i([])},[i]),m=(0,l.useCallback)(()=>e.reduce((e,t)=>e+t.quantity,0),[e]),f=(0,l.useCallback)(()=>e.reduce((e,t)=>e+t.price*t.quantity,0),[e]);return{cartItems:e,isLoading:a,addToCart:s,removeFromCart:o,updateQuantity:d,clearCart:u,getTotalItems:m,getTotalPrice:f,loadCart:n}},s=({product:e})=>{let{addToCart:t}=i();return(0,r.jsxs)("div",{className:"product-card fade-in",children:[e.image?r.jsx("div",{className:"w-full h-48 overflow-hidden",children:r.jsx("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover transition duration-500 ease-in-out transform hover:scale-105",onError:e=>{e.target.src="/images/placeholder-product.jpg"}})}):r.jsx("div",{className:"w-full h-48 bg-gray-200 flex items-center justify-center",children:r.jsx("span",{className:"text-gray-500",children:"Изображение отсутствует"})}),(0,r.jsxs)("div",{className:"p-4",children:[r.jsx("h3",{className:"text-lg font-serif font-bold text-chocolate mb-1",children:e.name}),r.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:e.description}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-3",children:[(0,r.jsxs)("span",{className:"text-xl font-bold text-chocolate",children:["от ",e.price.toLocaleString("ru-RU")," ₽"]}),r.jsx("button",{onClick:()=>{let a=Date.now();t({id:a,productId:e.id,name:e.name,price:e.price,image:e.image}),console.log(`Добавлен товар ${e.name} в корзину с ID элемента ${a}`)},className:"btn-primary text-sm py-1 px-3","aria-label":`Добавить ${e.name} в корзину`,children:"В корзину"})]}),r.jsx(c(),{href:`/product/${e.id}`,className:"text-mint hover:text-chocolate text-sm font-medium mt-2 inline-block",children:"Подробнее →"})]})]})}},5244:(e,t)=>{var a;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return a}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(a||(a={}))}};