exports.id=814,exports.ids=[814],exports.modules={1830:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{Z:()=>d});var a=r(997),l=r(6689),o=r(1664),c=r.n(o),n=r(1163),i=r(3673),h=e([i]);i=(h.then?(await h)():h)[0];let d=()=>{let[e,t]=(0,l.useState)(!1),r=(0,n.useRouter)(),s=i.k.getCurrentUser(),[o,h]=(0,l.useState)(0);(0,l.useEffect)(()=>{let e=()=>{let e=localStorage.getItem("cart");if(e)try{let t=JSON.parse(e).reduce((e,t)=>e+(t.quantity||0),0);h(t)}catch(e){console.error("Ошибка при подсчете товаров в корзине",e)}};e();let t=t=>{"cart"===t.key&&e()};return window.addEventListener("storage",t),()=>{window.removeEventListener("storage",t)}},[]);let d=[{name:"Главная",href:"/"},{name:"Каталог",href:"/catalog"},{name:"Конструктор",href:"/builder"},{name:"Акции",href:"/promotions"},{name:"О нас",href:"/about"},{name:"Блог",href:"/blog"},{name:"Доставка",href:"/delivery"},{name:"Контакты",href:"/contacts"}];return(0,a.jsxs)("nav",{className:"bg-white shadow-sm sticky top-0 z-40",children:[a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,a.jsxs)("div",{className:"flex justify-between h-16",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx(c(),{href:"/",className:"flex-shrink-0 flex items-center",children:a.jsx("span",{className:"text-2xl font-serif font-bold text-chocolate",children:"Уездный Кондитер"})}),a.jsx("div",{className:"hidden md:ml-6 md:flex md:space-x-4",children:d.map(e=>a.jsx(c(),{href:e.href,className:`nav-link ${r.pathname===e.href?"nav-link-active":""}`,children:e.name},e.href))})]}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)(c(),{href:"/cart",className:"p-2 text-chocolate hover:text-dark-chocolate relative",children:[a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),o>0&&a.jsx("span",{className:"absolute -top-1 -right-1 bg-gold text-chocolate text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:o})]}),s?(0,a.jsxs)("div",{className:"ml-4 relative",children:[(0,a.jsxs)("button",{onClick:()=>t(!e),className:"flex text-sm rounded-full focus:outline-none",children:[a.jsx("span",{className:"sr-only",children:"Открыть меню пользователя"}),a.jsx("div",{className:"h-8 w-8 rounded-full bg-chocolate flex items-center justify-center text-white font-bold",children:s.first_name?.charAt(0)||s.username.charAt(0)})]}),e&&(0,a.jsxs)("div",{className:"origin-top-right absolute right-0 mt-2 w-48 rounded-md shadow-lg py-1 bg-white ring-1 ring-black ring-opacity-5 focus:outline-none z-50",children:[a.jsx(c(),{href:"/account",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Личный кабинет"}),a.jsx(c(),{href:"/account/orders",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Мои заказы"}),a.jsx("button",{onClick:()=>{i.k.logout(),r.push("/"),t(!1)},className:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",children:"Выйти"})]})]}):(0,a.jsxs)("div",{className:"ml-4 flex space-x-2",children:[a.jsx(c(),{href:"/login",className:"btn-secondary text-sm",children:"Войти"}),a.jsx(c(),{href:"/register",className:"btn-primary text-sm",children:"Регистрация"})]}),(0,a.jsxs)("button",{type:"button",className:"ml-2 md:hidden inline-flex items-center justify-center p-2 rounded-md text-chocolate hover:text-dark-chocolate hover:bg-gray-100 focus:outline-none",onClick:()=>t(!e),children:[a.jsx("span",{className:"sr-only",children:"Открыть главное меню"}),a.jsx("svg",{className:"block h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})]})]})]})}),e&&a.jsx("div",{className:"md:hidden",children:a.jsx("div",{className:"pt-2 pb-3 space-y-1",children:d.map(e=>a.jsx(c(),{href:e.href,className:`block pl-3 pr-4 py-2 border-l-4 ${r.pathname===e.href?"bg-rose-50 border-gold text-chocolate":"border-transparent text-gray-600 hover:bg-gray-50 hover:border-gray-300"} sm:pl-5 sm:pr-6`,onClick:()=>t(!1),children:e.name},e.href))})})]})};s()}catch(e){s(e)}})},1457:(e,t,r)=>{"use strict";r.d(t,{Z:()=>l});var s=r(997),a=r(6689);let l=()=>{let[e,t]=(0,a.useState)(!1),[r]=(0,a.useState)([{id:1,title:"Добро пожаловать!",body:"Это тестовое уведомление.",read:!1}]),l=r.filter(e=>!e.read).length;return(0,s.jsxs)("div",{className:"fixed bottom-24 right-4 z-40",children:[(0,s.jsxs)("button",{onClick:()=>t(!e),className:"bg-chocolate text-white p-3 rounded-full shadow-lg relative",children:["\uD83D\uDD14",l>0&&s.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:l})]}),e&&(0,s.jsxs)("div",{className:"absolute bottom-16 right-0 w-80 bg-white rounded-lg shadow-xl border",children:[s.jsx("div",{className:"p-4 border-b",children:s.jsx("h3",{className:"font-bold",children:"Уведомления"})}),s.jsx("div",{className:"max-h-96 overflow-y-auto",children:0===r.length?s.jsx("div",{className:"p-4 text-center text-gray-500",children:"Нет уведомлений"}):r.map(e=>(0,s.jsxs)("div",{className:"p-4 border-b",children:[s.jsx("div",{className:"font-bold",children:e.title}),s.jsx("div",{className:"text-sm text-gray-600",children:e.body})]},e.id))})]})]})}},3673:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{k:()=>c});var a=r(9648),l=e([a]);a=(l.then?(await l)():l)[0];let o="http://localhost:8000/api",c={async login(e){try{let t=await a.default.post(`${o}/auth/login/`,e);return t.data.access&&(localStorage.setItem("access_token",t.data.access),localStorage.setItem("refresh_token",t.data.refresh),localStorage.setItem("user",JSON.stringify(t.data.user))),t.data}catch(e){throw console.error("Ошибка входа:",e),e}},async register(e){try{let t=await a.default.post(`${o}/auth/register/`,e);return t.data.access&&(localStorage.setItem("access_token",t.data.access),localStorage.setItem("refresh_token",t.data.refresh),localStorage.setItem("user",JSON.stringify(t.data.user))),t.data}catch(e){throw console.error("Ошибка регистрации:",e),e}},logout(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),localStorage.removeItem("user")},isAuthenticated:()=>!!localStorage.getItem("access_token"),getAccessToken:()=>localStorage.getItem("access_token"),getRefreshToken:()=>localStorage.getItem("refresh_token"),getCurrentUser(){let e=localStorage.getItem("user");if(e)try{return JSON.parse(e)}catch(e){console.error("Ошибка парсинга данных пользователя из localStorage",e)}return null},async refreshAccessToken(){let e=this.getRefreshToken();if(!e)return null;try{let t=await a.default.post(`${o}/auth/token/refresh/`,{refresh:e});return localStorage.setItem("access_token",t.data.access),t.data.access}catch(e){throw console.error("Ошибка обновления токена:",e),this.logout(),e}},async updateProfile(e){try{let t={headers:{Authorization:`Bearer ${this.getAccessToken()}`}},r=await a.default.put(`${o}/auth/profile/`,e,t);return localStorage.setItem("user",JSON.stringify(r.data)),r.data}catch(e){throw console.error("Ошибка обновления профиля:",e),e}}};a.default.interceptors.request.use(e=>{let t=c.getAccessToken();return t&&e.headers&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),a.default.interceptors.response.use(e=>e,async e=>{let t=e.config;if(e.response?.status===401&&t&&!t._retry){t._retry=!0;try{let e=await c.refreshAccessToken();if(e)return t.headers&&(t.headers.Authorization=`Bearer ${e}`),(0,a.default)(t)}catch(e){console.error("Не удалось обновить токен, выход из системы:",e),c.logout()}}return Promise.reject(e)}),s()}catch(e){s(e)}})},6814:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{default:()=>n});var a=r(997);r(6689),r(6764);var l=r(1830),o=r(1457),c=e([l]);l=(c.then?(await c)():c)[0];let n=function({Component:e,pageProps:t}){return(0,a.jsxs)(a.Fragment,{children:[a.jsx(l.Z,{}),a.jsx("main",{children:a.jsx(e,{...t})}),a.jsx(o.Z,{})]})};s()}catch(e){s(e)}})},6764:()=>{}};