"use strict";(()=>{var e={};e.id=771,e.ids=[771,888,660],e.modules={1323:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,s){return s in t?t[s]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,s)):"function"==typeof t&&"default"===s?t:void 0}}})},1441:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{config:()=>f,default:()=>u,getServerSideProps:()=>p,getStaticPaths:()=>h,getStaticProps:()=>x,reportWebVitals:()=>g,routeModule:()=>y,unstable_getServerProps:()=>P,unstable_getServerSideProps:()=>_,unstable_getStaticParams:()=>v,unstable_getStaticPaths:()=>j,unstable_getStaticProps:()=>b});var l=s(7093),r=s(5244),n=s(1323),i=s(2899),c=s.n(i),m=s(6814),o=s(361),d=e([m,o]);[m,o]=d.then?(await d)():d;let u=(0,n.l)(o,"default"),x=(0,n.l)(o,"getStaticProps"),h=(0,n.l)(o,"getStaticPaths"),p=(0,n.l)(o,"getServerSideProps"),f=(0,n.l)(o,"config"),g=(0,n.l)(o,"reportWebVitals"),b=(0,n.l)(o,"unstable_getStaticProps"),j=(0,n.l)(o,"unstable_getStaticPaths"),v=(0,n.l)(o,"unstable_getStaticParams"),P=(0,n.l)(o,"unstable_getServerProps"),_=(0,n.l)(o,"unstable_getServerSideProps"),y=new l.PagesRouteModule({definition:{kind:r.x.PAGES,page:"/account/profile",pathname:"/account/profile",bundlePath:"",filename:""},components:{App:m.default,Document:c()},userland:o});a()}catch(e){a(e)}})},361:(e,t,s)=>{s.a(e,async(e,a)=>{try{s.r(t),s.d(t,{default:()=>x});var l=s(997),r=s(6689),n=s(968),i=s.n(n),c=s(1664),m=s.n(c),o=s(1163),d=s(3673),u=e([d]);d=(u.then?(await u)():u)[0];let x=()=>{let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(!0),[n,c]=(0,r.useState)({first_name:"",last_name:"",email:"",phone:""}),[u,x]=(0,r.useState)(!1),[h,p]=(0,r.useState)(null),f=(0,o.useRouter)();(0,r.useEffect)(()=>{if(!d.k.isAuthenticated()){f.push("/login");return}let e=d.k.getCurrentUser();if(e){let s={id:e.id,username:e.username,email:e.email,first_name:e.first_name||"",last_name:e.last_name||"",phone:e.phone||""};t(s),c({first_name:s.first_name,last_name:s.last_name,email:s.email,phone:s.phone})}a(!1)},[f]);let g=e=>{let{name:t,value:s}=e.target;c(e=>({...e,[t]:s}))},b=async e=>{e.preventDefault(),x(!0),p(null);try{await new Promise(e=>setTimeout(e,1e3));let e=d.k.getCurrentUser();if(e){let s={...e,first_name:n.first_name,last_name:n.last_name,email:n.email,phone:n.phone};localStorage.setItem("user",JSON.stringify(s)),t(s)}p({type:"success",text:"Профиль успешно обновлен!"})}catch(e){p({type:"error",text:"Ошибка при обновлении профиля"})}finally{x(!1)}};return s?l.jsx("div",{className:"min-h-screen bg-cream flex items-center justify-center",children:l.jsx("div",{className:"text-xl",children:"Загрузка..."})}):e?(0,l.jsxs)("div",{className:"min-h-screen bg-cream",children:[(0,l.jsxs)(i(),{children:[l.jsx("title",{children:"Настройки профиля - Уездный Кондитер"}),l.jsx("meta",{name:"description",content:"Редактирование профиля в кондитерской 'Уездный Кондитер'"})]}),(0,l.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l.jsx("div",{className:"mb-8",children:(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[l.jsx("h1",{className:"text-3xl font-serif font-bold text-chocolate mb-2",children:"Настройки профиля"}),l.jsx("p",{className:"text-gray-600",children:"Редактирование личной информации"})]}),l.jsx(m(),{href:"/account",className:"text-chocolate hover:underline",children:"← Назад в кабинет"})]})}),(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-6 max-w-2xl",children:[h&&l.jsx("div",{className:`mb-6 p-4 rounded-lg ${"success"===h.type?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:h.text}),(0,l.jsxs)("form",{onSubmit:b,children:[(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,l.jsxs)("div",{children:[l.jsx("label",{htmlFor:"first_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Имя"}),l.jsx("input",{type:"text",id:"first_name",name:"first_name",value:n.first_name,onChange:g,className:"input-field w-full",placeholder:"Введите ваше имя"})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{htmlFor:"last_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Фамилия"}),l.jsx("input",{type:"text",id:"last_name",name:"last_name",value:n.last_name,onChange:g,className:"input-field w-full",placeholder:"Введите вашу фамилию"})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),l.jsx("input",{type:"email",id:"email",name:"email",value:n.email,onChange:g,className:"input-field w-full",placeholder:"your@email.com"})]}),(0,l.jsxs)("div",{children:[l.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Телефон"}),l.jsx("input",{type:"tel",id:"phone",name:"phone",value:n.phone,onChange:g,className:"input-field w-full",placeholder:"+7 (XXX) XXX-XX-XX"})]})]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[l.jsx("button",{type:"submit",disabled:u,className:`btn-primary py-2 px-6 ${u?"opacity-50 cursor-not-allowed":""}`,children:u?"Сохранение...":"Сохранить изменения"}),l.jsx(m(),{href:"/account/change-password",className:"mt-4 sm:mt-0 text-chocolate hover:underline",children:"Изменить пароль"})]})]})]}),(0,l.jsxs)("div",{className:"mt-8 bg-white rounded-xl shadow-md p-6 max-w-2xl",children:[l.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Опасная зона"}),l.jsx("p",{className:"text-gray-700 mb-4",children:"Удаление аккаунта приведет к безвозвратному удалению всех ваших данных, включая историю заказов и персональную информацию."}),l.jsx("button",{onClick:()=>{confirm("Вы уверены, что хотите удалить свой аккаунт? Это действие нельзя отменить.")&&(d.k.logout(),f.push("/"))},className:"bg-red-600 hover:bg-red-700 text-white py-2 px-4 rounded-lg transition",children:"Удалить аккаунт"})]})]})]}):l.jsx("div",{className:"min-h-screen bg-cream flex items-center justify-center",children:(0,l.jsxs)("div",{className:"text-center",children:[l.jsx("h1",{className:"text-2xl font-bold text-chocolate mb-4",children:"Ошибка загрузки данных"}),l.jsx(m(),{href:"/account",className:"text-chocolate hover:underline",children:"← Вернуться в кабинет"})]})})};a()}catch(e){a(e)}})},5244:(e,t)=>{var s;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return s}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(s||(s={}))},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},968:e=>{e.exports=require("next/head")},6689:e=>{e.exports=require("react")},6405:e=>{e.exports=require("react-dom")},997:e=>{e.exports=require("react/jsx-runtime")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},6162:e=>{e.exports=require("stream")},1568:e=>{e.exports=require("zlib")},9648:e=>{e.exports=import("axios")}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[567,424,899,814],()=>s(1441));module.exports=a})();